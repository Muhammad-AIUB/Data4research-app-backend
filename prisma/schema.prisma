generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model hematology_results {
  id                     String                 @id
  session_id             String
  test_name              String
  value                  String
  unit                   String?
  is_favourite           Boolean                @default(false)
  notes                  String?
  created_at             DateTime               @default(now())
  investigation_sessions investigation_sessions @relation(fields: [session_id], references: [id], onDelete: Cascade)

  @@index([session_id])
}

model investigation_images {
  id                     String                 @id
  investigation_id       String
  image_path             String
  image_type             String
  description            String?
  created_at             DateTime               @default(now())
  investigation_sessions investigation_sessions @relation(fields: [investigation_id], references: [id], onDelete: Cascade)

  @@index([investigation_id])
}

model investigation_sessions {
  id                   String                 @id
  patient_id           String
  investigation_date   DateTime               @db.Date
  created_at           DateTime               @default(now())
  updated_at           DateTime
  hematology_results   hematology_results[]
  investigation_images investigation_images[]
  patients             patients               @relation(fields: [patient_id], references: [id], onDelete: Cascade)
  lft_results          lft_results[]
  rft_results          rft_results[]

  @@index([patient_id])
}

model lft_results {
  id                     String                 @id
  session_id             String
  test_name              String
  value                  String
  unit                   String?
  test_method            String?
  is_favourite           Boolean                @default(false)
  notes                  String?
  created_at             DateTime               @default(now())
  investigation_sessions investigation_sessions @relation(fields: [session_id], references: [id], onDelete: Cascade)

  @@index([session_id])
}

model patient_images {
  id          String   @id
  patient_id  String
  image_path  String
  image_type  String
  description String?
  created_at  DateTime @default(now())
  patients    patients @relation(fields: [patient_id], references: [id], onDelete: Cascade)

  @@index([patient_id])
}

model patients {
  id                           String                   @id
  user_id                      String
  patient_id                   String
  name                         String
  age                          Int
  sex                          String
  ethnicity                    String
  religion                     String
  nid_number                   String?
  patient_mobile               String
  spouse_mobile                String?
  district                     String
  short_history                String
  surgical_history             String
  family_history               String
  past_illness                 String
  tags                         String[]
  special_notes                String
  final_diagnosis              String
  created_at                   DateTime                 @default(now())
  updated_at                   DateTime
  date_of_birth                DateTime                 @db.Date
  first_degree_relative_mobile String
  address_details              String?
  investigation_sessions       investigation_sessions[]
  patient_images               patient_images[]
  users                        users                    @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, patient_id])
  @@index([name])
  @@index([patient_mobile])
  @@index([user_id])
}

model rft_results {
  id                     String                 @id
  session_id             String
  test_name              String
  value                  String
  unit                   String?
  is_favourite           Boolean                @default(false)
  notes                  String?
  created_at             DateTime               @default(now())
  investigation_sessions investigation_sessions @relation(fields: [session_id], references: [id], onDelete: Cascade)

  @@index([session_id])
}

model users {
  id            String     @id
  username      String     @unique
  email         String?    @unique
  password_hash String
  created_at    DateTime   @default(now())
  updated_at    DateTime
  patients      patients[]
}
